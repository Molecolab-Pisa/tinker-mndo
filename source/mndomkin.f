      subroutine mndomkin()
        use atomid
        use atoms
        use mndo
        use charge

        implicit none

        integer :: i, j, l, elb
        real*8 :: lapos(3)

        integer trimtext
  
  10   format(i2, 8x, 3(F10.5,2x,i2,6x))
  20   format(3F12.4,F8.4)

        open(unit=mndo_in_unit, file=mndo_in)

c       Write input options
        call mndo_out_keys(mndo_in_unit)
        if(mndo_debug) then
          write(6, *) "INPUT SECTION"
          call mndo_out_keys(6)
          write(6, *)
        end if
        
c       Write header comments
        write(mndo_in_unit, *) "Generated by Tinker-MNDO interface."
        write(mndo_in_unit, *) "Finger crossed."

        do i=1, nqmatoms
          write(mndo_in_unit, 10) atomic(qmlist(i)), x(qmlist(i)), 1,
     &    y(qmlist(i)), 1, z(qmlist(i)), 1
        end do

        if(mndo_usela) then
          do i=1, mndo_nla
c           Compute coordinates of LAs (fixed distance)
            call mndo_lapos(i, lapos)

c           write down coordinates of LAs
            write(mndo_in_unit, 10) 1, lapos(1), 1, lapos(2), 1, 
     &      lapos(3), 1
          end do
        end if

        write(mndo_in_unit, *) ""
     
        if(mndo_multistate) then
          if(mndo_ms_all) then
            do i=1, mndo_nstates
              write(mndo_in_unit, "(I4)", advance="no") i
            end do
            write(mndo_in_unit, *) ""
          else
              write(mndo_in_unit, "(I4)") mndo_currentstate
          end if
        end if

        do i=1, mndo_neline
          l = trimtext(mndo_eline(i))
          write(mndo_in_unit, *) mndo_eline(i)(:l)
        end do

        if(mndo_usela) then
c         write down link atoms list
          do i=1, mndo_nla
            if(mod(i,16) .eq. 0) write(mndo_in_unit, *) ""
            write(mndo_in_unit, "(I5)", advance="no") nqmatoms + i
          end do
          write(mndo_in_unit, *) ""
        end if

        do i=1, n-nqmatoms
          write(mndo_in_unit, 20) x(mmlist(i)), y(mmlist(i)), 
     $    z(mmlist(i)), pchg(mmlist(i))
        end do

        close(mndo_in_unit)
      end
